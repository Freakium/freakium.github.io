<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no">
  <title>Ross Chan's Projects</title>
  <link rel="icon" type="image/x-icon" href="src/img/favicon.ico">
  <link rel=stylesheet href=src/bootstrap/css/bootstrap-icons.min.css>
  <link rel=stylesheet href=src/bootstrap/css/bootstrap.min.css>
  <style>
    :root {
      --ultra-rare: repeating-linear-gradient(to right, rgb(50, 160, 240), rgb(125, 60, 189), rgb(50, 160, 240));
    }

    body {
      display: flex;
      flex-direction: column;
      height: 100vh;
      margin: 0;
      font-family: 'Roboto', sans-serif;
    }

    main {
      margin: 1rem;
    }

    footer {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-top: auto;
      padding-bottom: .5rem;

      span {
        margin-left: .25rem;
      }
    }

    .hoverCards .card:hover {
      opacity: 1 !important;
    }
    .hoverCards h3 {
      margin-bottom: 0;
    }

    .projectCards {
      img {
        max-width: 100%;
      }
    }

    .ultra-rare {
      color: transparent;
      background: var(--ultra-rare);
      background-size: 50% 100%;
      background-clip: text;
      animation: ultra-rare-anim 3s linear infinite;
    }
    @keyframes ultra-rare-anim {
      0% {
        background-position: 100% 0;
      }
    }
    
    #titleName {
      font-size: 4.5rem;
    }

    #themeBtn {
      position: fixed;
      top: 10px;
      right: 10px;
    }

    #viewScreenBody {
      background: url('src/img/stars.jpg');
    }

    #viewScreenMsg {
      top: 10%;
    }

    #warpCanvas {
      width: 100vw;
      height: 100vh;
    }
    
    .lcarsText {
      font-family: Helvetica LT UltraCompressed, Helvetica, sans-serif;
      color: #f9cb59;
      text-transform: uppercase;
    }
    @font-face {
      font-family: Helvetica LT UltraCompressed;
      src: url('src/fonts/helveticalt_ultracompressed.ttf');
    }

    /* Animated Background */
    .bg {
      animation: sliderX 26s ease-in-out infinite alternate;
      background-image: linear-gradient(-45deg, rgba(88, 88, 88, 0.13) 50%, rgba(88, 88, 88, 0.055) 50%);
      bottom: 0;
      left: -50%;
      opacity: 0.5;
      position: fixed;
      right: -50%;
      top: 0;
      z-index: -1;
    }
    .bg2 {
      animation-direction: alternate-reverse;
      animation-duration: 27s;
    }
    .bg3 {
      animation-duration: 28s;
    }
    @keyframes sliderX {
      0% {
        transform: translateX(-25%);
      }
      100% {
        transform: translateX(25%);
      }
    }
    @keyframes sliderY {
      0% {
        transform: translateY(-50%);
      }
      100% {
        transform: translateY(50%);
      }
    }
    @keyframes spinner {
      0% {
        transform: rotate(-90deg);
      }
      100% {
        transform: rotate(90deg);
      }
    }
    @keyframes microscope {
      from {
        transform: scale(0.5) rotate(0deg);
        opacity: 1;
      }
      to {
        transform: scale(5) rotate(960deg);
        opacity: 0;
      }
    }

    /* Viewscreen Interactables */
    .turnFade {
      transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
      transform: rotate(180deg);
      opacity: 0;
    }
    .turnFade:hover, .turnFadeOn {
      transform: rotate(0deg);
      opacity: 1;
    }
    #warpDisplay:hover {
      opacity: 1;
    }
  </style>
</head>

<body>
  <!-- ANIMATED BACKGROUND -->
  <div class="bg"></div>
  <div class="bg bg2"></div>
  <div class="bg bg3"></div>

  <main>
    <button class="btn btn-secondary rounded-circle z-1" id="themeBtn" onclick="toggleTheme()"><i class="bi bi-moon-stars-fill"></i></button>
    
    <!-- PERSONAL CARD -->
    <div class="container bg-secondary-subtle shadow rounded-4 text-center mt-5 p-5">
      <div class="d-flex justify-content-center">
        <h1 class="ultra-rare fw-bold" id="titleName">Ross Chan</h1>
      </div>
      <h3>Full Stack Developer</h3>
      <h5 class="text-secondary">I have 6+ years of experience with web applications ranging from WordPress eCommerce sites to a tutor âž¡ student scheduling platform.</h5>
      <div class="d-flex justify-content-center flex-column flex-sm-row gap-2">
        <div class="badge bg-success">PHP</div>
        <div class="badge bg-primary">JavaScript</div>
        <div class="badge bg-primary-subtle text-primary-emphasis">JQuery</div>
        <div class="badge bg-warning-subtle text-warning-emphasis">HTML</div>
        <div class="badge bg-danger-subtle text-danger-emphasis">CSS</div>
        <div class="badge bg-success-subtle text-success-emphasis">mySQL</div>
      </div>
      <div class="mt-3">
        <a href="https://drive.google.com/file/d/1M_52iWgpXlcJkzs8fYvKz5dCcv4j2fQl/view" target="_blank" class="btn btn-outline-primary" title="View PDF">Portfolio</a>
      </div>
    </div>
    <!-- /PERSONAL CARD -->

    <!-- HOVER CARDS -->
    <div class="container mt-5 p-4">
      <div class="row hoverCards row-gap-4">
        <div class="col-sm-4">
          <div class="card bg-warning-subtle opacity-75 border-3 shadow">
            <div class="card-title text-center text-warning-emphasis pt-2"><h3>Front End</h3></div>
            <div class="card-body py-0">
              <ul>
                <li><span class="text-warning-emphasis">Bootstrap</span></li>
                <li><span class="text-warning-emphasis">React</span></li>
                <li><span class="text-warning-emphasis">Angular</span></li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-sm-4">
          <div class="card bg-success-subtle opacity-75 border-3 shadow">
            <div class="card-title text-center text-success-emphasis pt-2"><h3>Back End</h3></div>
            <div class="card-body py-0">
              <ul>
                <li><span class="text-success-emphasis">Laravel</span></li>
                <li><span class="text-success-emphasis">MS SQL Server</span></li>
                <li><span class="text-success-emphasis">phpMyAdmin</span></li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-sm-4">
          <div class="card bg-primary-subtle opacity-75 border-3 shadow">
            <div class="card-title text-center text-primary-emphasis pt-2"><h3>WordPress</h3></div>
            <div class="card-body py-0">
              <ul>
                <li><span class="text-primary-emphasis">WooCommerce</span></li>
                <li><span class="text-primary-emphasis">Jetpack</span></li>
                <li><span class="text-primary-emphasis">Inventory updates</span></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- /HOVER CARDS -->

    <!-- PERSONAL PROJECTS -->
    <div class="container position-relative bg-secondary-subtle shadow rounded-4 mt-5 p-5 projectCards">
      <button class="btn btn-link position-absolute top-0 end-0" data-bs-toggle="offcanvas" data-bs-target="#viewScreen" title="Viewscreen On">
        <i class="bi bi-rocket"></i>
      </button>

      <div class="d-flex justify-content-center">
        <h1 class="ultra-rare fw-bold">Personal Projects</h1>
      </div>

      <div class="card mt-3 p-4">
        <div class="card-title"><h3><a href="invman">Inventory Manager</a></h3></div>
        <div class="card-body">
          <div class="row">
            <div class="col-lg-6">
              <p>Manage your inventory with this simple JavaScript tool.</p>
              <div class="mb-3">
                <div class="badge" style="background-color: blueviolet">Bootstrap</div>
                <div class="badge bg-primary">JavaScript</div>
              </div>
            </div>
            <div class="col-lg-6"><a href="invman"><img src="src/img/InvMan.jpg"></a></div>
          </div>
        </div>
      </div>

      <div class="card mt-3 p-4">
        <div class="card-title"><h3><a href="motivgen">Motivational Poster Generator</a></h3></div>
        <div class="card-body">
          <div class="row">
            <div class="col-lg-6">
              <p>Create a motivational poster by uploading your own image or searching for it courtesy of Pexels.</p>
              <div class="mb-3">
                <div class="badge bg-danger">Angular</div>
                <div class="badge" style="background-color: rgb(5, 160, 129)">Pexels</div>
              </div>
            </div>
            <div class="col-lg-6"><a href="motivgen"><img src="src/img/MotivGen.jpg"></a></div>
          </div>
        </div>
      </div>

      <div class="card mt-3 p-4">
        <div class="card-title"><h3><a href="shipnamegen">Starship Name Generator</a></h3></div>
        <div class="card-body">
          <div class="row">
            <div class="col-lg-6">
              <p>Generates a list of names for your starship.</p>
              <div class="mb-3">
                <div class="badge" style="background-color: blueviolet">Bootstrap</div>
                <div class="badge bg-primary">JavaScript</div>
              </div>
            </div>
            <div class="col-lg-6"><a href="shipnamegen"><img src="src/img/ShipGen.jpg"></a></div>
          </div>
        </div>
      </div>
    </div>
    <!-- /PERSONAL PROJECTS -->
    
  </main>

  <!-- MODALS -->
  <div class="offcanvas offcanvas-top h-100" id="viewScreen" tabindex="-1">
    <div class="offcanvas-body bg-black p-0 d-flex align-items-center justify-content-center" id="viewScreenBody">
      <button id="closeViewScreen" type="button" class="btn position-fixed end-0 top-0 turnFade" data-bs-dismiss="offcanvas" aria-label="Close" title="Viewscreen Off">
        <i class="bi bi-x-lg text-light"></i>
      </button>
      <div id="warpDisplay" class="position-fixed col-10 col-md-3 mx-auto top-0 fade">
        <h3 class="lcarsText text-center user-select-none">
          <span id="speedHeader">Sublight Speed:</span>
          <span id="speedValue" class="text-primary">Half Impulse</span>
        </h3>
        <input type="range" id="impulseInput" class="form-range" min="0" max="1" step="0.25" value="0.5" autocomplete="off">
        <input type="range" id="warpInput" class="form-range d-none" min="1" max="10" value="5" autocomplete="off">
      </div>
      <div class="position-fixed start-0 bottom-0 user-select-none">
        <button type="button" class="btn btn-lg turnFade" onclick="firePhaser()" aria-label="Fire" title="Fire Phaser">
          <i class="bi bi-fire text-danger"></i>
        </button>
        <button type="button" class="btn btn-lg turnFade" onclick="firePulsePhaser()" aria-label="Fire" title="Fire Pulse Phasers">
          <i class="bi bi-fire text-warning"></i>
        </button>
      </div>
      <div class="position-fixed end-0 bottom-0 user-select-none">
        <button type="button" class="btn btn-lg turnFade" onclick="fireTorpedo('photon')" aria-label="Fire" title="Fire Photon Torpedo">
          <i class="bi bi-rocket-fill text-danger"></i>
        </button>
        <button type="button" class="btn btn-lg turnFade" onclick="fireTorpedo('quantum')" aria-label="Fire" title="Fire Quantum Torpedo">
          <i class="bi bi-rocket-fill text-primary"></i>
        </button>
      </div>
      <div id="viewScreenMsg" class="position-fixed mx-auto text-center lcarsText"></div>
      <canvas id="warpCanvas"></canvas>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script src=src/bootstrap/js/bootstrap.bundle.min.js></script>
  <script>
    (function () {
      const BACKGROUNDS = ['sliderX', 'sliderY', 'spinner', 'microscope'];

      addEventListener("load", (e) => {
        // set to dark mode if system theme is dark
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          toggleTheme();
        }

        // set random background animation
        randomBackground();
      });

      /**
       * Toggles the theme between light and dark mode
       */
      window.toggleTheme = () => {
        const btn = document.getElementById('themeBtn');
        let html = document.documentElement;

        if (html.hasAttribute('data-bs-theme')) {
          html.removeAttribute('data-bs-theme');
          btn.innerHTML = `<i class="bi bi-moon-stars-fill"></i>`;
        }
        else {
          html.setAttribute('data-bs-theme', 'dark');
          btn.innerHTML = `<i class="bi bi-brightness-high-fill"></i>`;
        }
      }

      /**
       * Randomly sets the main background animation
       */
      function randomBackground() {
        let rand = getRandomInt(0, BACKGROUNDS.length - 1);
        let animation = BACKGROUNDS[rand];

        document.querySelectorAll('.bg').forEach(bg => {
          bg.style.animationName = animation;
        });
      }

      // WARP SPEED SIMULATION
      /****************************************/
      /********** Screen **********/
      let canvasWidth, canvasHeight, centerX, centerY;
      let viewScreen = document.getElementById('warpCanvas');
      let mainContext = viewScreen.getContext('2d');
      let isWarp = false;
      let clickCount = 0;

      /********** Stars **********/
      const FRAMES_PER_SECOND = 60;
      let impulseSpeed = 0.5;
      let warpSpeed = 5;
      let stars = [];
      let animationId;

      /********** Weapons **********/
      let phasers = [];
      let pulsePhasers = [];
      let torpedoes = [];

      /********** Timings **********/
      let clickTimer, msgTimer;
      let interval = Math.floor(1000 / FRAMES_PER_SECOND);
      let startTime = performance.now();
      let previousTime = startTime;
      let currentTime = 0;
      let deltaTime = 0;

      /********** Listeners **********/
      // Viewscreen On
      document.getElementById('viewScreen').addEventListener('shown.bs.offcanvas', e => {
        screenInit();
        showViewScreenHUD();
        displaySpeed('impulse', impulseSpeed);

        playAudio('src/aud/viewscreenOn.wav');
      });
      // Viewscreen Off
      document.getElementById('viewScreen').addEventListener('hidden.bs.offcanvas', e => {
        screenClear();
        isWarp = false;

        playAudio('src/aud/viewscreenOff.wav');
      });
      // Set Impulse Speed
      document.getElementById('impulseInput').addEventListener('input', e => {
        let val = parseFloat(e.target.value);
        setShipSpeed('impulse', val);

        playAudio('src/aud/beep.mp3');
      });
      // Set Warp Speed
      document.getElementById('warpInput').addEventListener('input', e => {
        let val = parseFloat(e.target.value);
        setShipSpeed('warp', val);

        playAudio('src/aud/beep.mp3');
      });
      // Click any area of the viewscreen to go to warp
      viewScreen.addEventListener('click', () => {
        isWarp = !isWarp;
        clickCount++;

        if(isWarp) {
          document.getElementById('warpInput').classList.remove('d-none');
          document.getElementById('impulseInput').classList.add('d-none');

          playAudio('src/aud/warpEnter.wav');

          // prevents slow streaks using impulse speeds
          setShipSpeed('warp', warpSpeed);
        }
        else {
          document.getElementById('impulseInput').classList.remove('d-none');
          document.getElementById('warpInput').classList.add('d-none');

          playAudio('src/aud/warpExit.wav');

          // keeps warp streaks at same speed
          displaySpeed('impulse', impulseSpeed);
        }

        if(clickCount === 3) {
          clickCount = 0;
          showViewScreenHUD();
        }
      });
      // Change screen orientation
      screen.orientation.addEventListener('change', () => {
        let viewScreenOn = document.getElementById('viewScreen').classList.contains('show');
        if(viewScreenOn) {
          // use resize event to get proper screen dimensions (otherwise it usually picks up the previous dimensions)
          var afterOrientation = function() {
            screenInit();
            window.removeEventListener('resize', afterOrientation);
          };
          window.addEventListener('resize', afterOrientation);
        }
      });

      /********** Interaction **********/
      /**
       * Animate a torpedo firing into the distance.
       */
      window.firePhaser = () => {
        if(isWarp) {
          viewScreenMessage('Phasers cannot fire during warp', 4000);
          playAudio('src/aud/warning.mp3');

          return false;
        }

        let phaser = new Phaser();
        phaser.playSound();
        phasers.push(phaser);
      }

      /**
       * Animate a torpedo firing into the distance.
       */
      window.firePulsePhaser = () => {
        if(isWarp) {
          viewScreenMessage('Pulse Phasers cannot fire during warp', 4000);
          playAudio('src/aud/warning.mp3');

          return false;
        }

        let pulse = new PulsePhaser();
        pulse.playSound();
        pulsePhasers.push(pulse);
      }

      /**
       * Animate a torpedo firing into the distance.
       */
      window.fireTorpedo = (type) => {
        let torpedo = new Torpedo(type);
        torpedo.playSound();
        torpedoes.push(torpedo);
      }

      /********** Classes **********/
      /**
       * Draw an animated star/starstreak to the canvas.
       */
      class Star {
        #screenEdge = canvasWidth >= canvasHeight ? canvasWidth : canvasHeight;

        constructor() {
          let star = this.#generateStar();

          this.x = star.x;
          this.y = star.y;
          this.radiusMax = star.radiusMax;
          this.speed = star.speed;

          this.counter = getRandomInt(1, this.#screenEdge);
        }

        #generateStar() {
          let coords;

          // stars are generated in a warp tunnel
          if(isWarp) {
            const RADIUS = 10;
            const isLandscape = canvasWidth >= canvasHeight;

            let angle = getRandomInt(0, 360);
            coords = {
              x: (isLandscape ? RADIUS : RADIUS * 2) * Math.cos(angle),
              y: (isLandscape ? RADIUS * 2 : RADIUS) * Math.sin(angle)
            }
          }
          // stars are generated anywhere on the screen
          else {
            coords = {
              x: getRandomInt(-centerX, centerX),
              y: getRandomInt(-centerY, centerY)
            };
          }

          return {
            x: coords.x,
            y: coords.y,
            radiusMax: getRandomInt(1, 3),
            speed: this.#speedFormula()
          }
        }

        #speedFormula() {
          return isWarp
            ? getRandomFloat(5, 5 * warpSpeed)
            : impulseSpeed === 0
              ? 0
              : getRandomFloat(1, 10 * impulseSpeed)
        }

        drawStar() {
          this.counter -= this.speed;

          if (this.counter < 1) {
            let star = this.#generateStar();

            this.x = star.x;
            this.y = star.y;
            this.speed = star.speed;
            this.counter = this.#screenEdge;
            
            // star specific
            this.radiusMax = star.radiusMax;

            // warp specific
            this.warpColour = getRandomInt(0, 1) ? "#a1d7ff" : "#64adcc";
            this.warpLength = getRandomFloat(1.2, 1.8);
          }

          let xRatio = this.x / this.counter;
          let yRatio = this.y / this.counter;

          let starX = remap(xRatio, 0, 1, 0, canvasWidth);
          let starY = remap(yRatio, 0, 1, 0, canvasHeight);

          this.radius = remap(this.counter, 0, this.#screenEdge, this.radiusMax, 0);

          // Begin drawing
          mainContext.beginPath();

          // Warp speed
          if(isWarp) {
            mainContext.moveTo(starX, starY);
            let prevLoc = {
              x: this.warpLength * starX,
              y: this.warpLength * starY
            };
            mainContext.lineTo(prevLoc.x, prevLoc.y);
            mainContext.strokeStyle = this.warpColour; 
            mainContext.lineWidth = this.radiusMax; 
            mainContext.stroke();
          }
          // Impulse speed
          else {
            mainContext.arc(starX, starY, this.radius, 0, Math.PI * 2, false);
            mainContext.fillStyle = "#fff";
            mainContext.fill();
          }

          // Stop drawing
          mainContext.closePath();
        }

        setSpeed() {
          this.speed = this.#speedFormula();
        }
      }

      /**
       * Draw an animated phaser to the canvas.
       */
      class Phaser {
        constructor() {
          this.x = getRandomInt(-centerX, centerX); // introduce some randomness to the shots
          this.y = centerY + 2;
          this.duration = 135;
          this.sound = 'src/aud/phaser.mp3';
        }

        drawPhaser() {
          this.duration -= 1;

          if(this.duration < 1) {
            return true;
          }

          // colours
          const GLOW_COLOUR = '#fc1e1e';
          const CORE_COLOUR = '#f2ba5f';
          const GLOW_SIZE = 32;

          // Set glow properties
          mainContext.shadowColor = GLOW_COLOUR;
          mainContext.shadowBlur = GLOW_SIZE;

          // Draw the beam
          mainContext.beginPath();
          mainContext.moveTo(0, 0);
          mainContext.lineTo(this.x, this.y);
          mainContext.lineTo(this.x + 8, this.y);
          mainContext.fillStyle = CORE_COLOUR;
          mainContext.fill();

          // Reset shadow properties to avoid affecting other drawings
          mainContext.shadowColor = 'transparent';
          mainContext.shadowBlur = 0;
        }

        playSound() {
          playAudio(this.sound);
        }
      }

      /**
       * Draw quad pulse phasers to the canvas.
       */
      class PulsePhaser {
        #screenEdge = canvasWidth >= canvasHeight ? canvasWidth : canvasHeight;

        constructor() {
          this.x = [-6, -5, 6, 5];
          this.y = [5, 6];

          this.length = 1.8;
          this.sound = 'src/aud/pulsephaser.mp3';

          this.counter = 1;
          this.speed = 20;
        }

        drawPulsePhaser() {
          this.counter += this.speed;

          if(this.counter > this.#screenEdge) {
            return true;
          }

          // colours
          const GLOW_COLOUR = '#fc1e1e';
          const CORE_COLOUR = '#f2ba5f';
          const GLOW_SIZE = 32;

          // Set glow properties
          mainContext.shadowColor = GLOW_COLOUR;
          mainContext.shadowBlur = GLOW_SIZE;

          // Draw the pulse
          for(let i = 0; i < this.x.length; i++) {
            let xRatio = this.x[i] / this.counter;
            let yRatio = this.y[i % 2] / this.counter;

            let starX = remap(xRatio, 0, 1, 0, canvasWidth);
            let starY = remap(yRatio, 0, 1, 0, canvasHeight);

            let prevLoc = {
              x: this.length * starX,
              y: this.length * starY
            };

            mainContext.beginPath();
            mainContext.moveTo(starX, starY);
            mainContext.lineTo(prevLoc.x, prevLoc.y);
            mainContext.lineWidth = 3;
            mainContext.strokeStyle = CORE_COLOUR;
            mainContext.stroke();
          }

          // Reset shadow properties to avoid affecting other drawings
          mainContext.shadowColor = 'transparent';
          mainContext.shadowBlur = 0;
        }

        playSound() {
          playAudio(this.sound);
        }
      }

      /**
       * Draw an animated torpedo to the canvas.
       */
      class Torpedo {
        constructor(type) {
          this.x = getRandomInt(-5, 5); // introduce some randomness to the shots
          this.y = centerY;
          this.radius = Math.floor(canvasHeight / 25);
          this.flareAngle = 0;
          this.speed = 6;

          this.counter = canvasHeight;

          switch(type) {
            case 'photon':
              this.shape = 'circle';
              this.glowSize = 32;
              this.glowColour = '#fa1400';
              this.coreOuterColour = '#800a00';
              this.coreInnerColour = '#f4fd7c';
              this.flareSize = 2;
              this.sound = 'src/aud/photon.wav';
              break;
            case 'quantum':
              this.shape = 'ellipse';
              this.glowSize = 48;
              this.glowColour = '#55b8fa';
              this.coreOuterColour = '#1b303e';
              this.coreInnerColour = '#ccc';
              this.flareSize = 0.3;
              this.sound = 'src/aud/quantum.wav';
          }
        }

        drawTorpedo() {
          this.counter -= this.speed;

          if(this.radius < 1) {
            return true;
          }

          this.y -= this.speed;
          this.radius -= 0.5;
          this.flareAngle = (this.flareAngle + 10) % 360;

          // Set glow properties (outer core)
          mainContext.shadowColor = this.glowColour;
          mainContext.shadowBlur = this.glowSize;

          // Draw the outer core
          mainContext.beginPath();
          switch(this.shape) {
            case 'ellipse':
              mainContext.ellipse(this.x, this.y, this.radius / 2, this.radius, Math.PI / 2, 0, Math.PI * 2);
              break;
            default: // circle
              mainContext.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
          }
          mainContext.fillStyle = this.coreOuterColour;
          mainContext.fill();

          // Set glow properties (inner core)
          mainContext.shadowColor = this.coreInnerColour;
          mainContext.shadowBlur = 15;

          // Draw the inner core
          let innerRadius = this.radius / 5;
          mainContext.beginPath();
          switch(this.shape) {
            case 'ellipse':
              mainContext.ellipse(this.x, this.y, innerRadius / 2, innerRadius, Math.PI / 2, 0, Math.PI * 2);
              break;
            default: // circle
              mainContext.arc(this.x, this.y, innerRadius, 0, Math.PI * 2);
          }
          mainContext.fillStyle = this.coreInnerColour;
          mainContext.fill();

          // Prepare rotating flare animation
          mainContext.save();
          mainContext.translate(this.x, this.y);
          mainContext.rotate(this.flareAngle);

          // Draw flare
          mainContext.moveTo(0, 0);
          mainContext.lineTo(this.x, this.radius * this.flareSize);
          mainContext.strokeStyle = this.coreInnerColour;
          mainContext.lineWidth = this.radius / 10;
          mainContext.stroke();
          mainContext.restore();

          // Reset shadow properties to avoid affecting other drawings
          mainContext.shadowColor = 'transparent';
          mainContext.shadowBlur = 0;

          // Stop drawing
          mainContext.closePath();
        }

        playSound() {
          playAudio(this.sound);
        }
      }

      /********** Private Functions **********/
      /**
       * Initialize values for current screen size.
       */
      function screenInit() {
        screenClear();

        canvasWidth = viewScreen.offsetWidth;
        canvasHeight = viewScreen.offsetHeight;
        viewScreen.width = canvasWidth;
        viewScreen.height = canvasHeight;

        centerX = Math.floor(canvasWidth * 0.5);
        centerY = Math.floor(canvasHeight * 0.5);

        setup();
        draw();
      }

      /**
       * Clear the canvas.
       */
      function screenClear() {
        mainContext.clearRect(0, 0, canvasWidth, canvasHeight);
        cancelAnimationFrame(animationId);
      }

      /**
       * Initialize starfield.
       */
      function setup() {
        stars = [];

        // let total number of stars be half the pixel count of the longest screen length (calculation already stored in center*)
        let totalStars = canvasWidth >= canvasHeight ? centerX : centerY;

        for (let i = 0; i < totalStars; i++) {
          let star = new Star();
          stars.push(star);
        }
      }

      /**
       * Draw the starfield onto the canvas.
       */
      function draw(timestamp) {
        currentTime = timestamp;
        deltaTime = currentTime - previousTime;

        if (deltaTime > interval) {
          previousTime = currentTime - (deltaTime % interval);

          mainContext.clearRect(0, 0, canvasWidth, canvasHeight);
          mainContext.fillStyle = "transparent";
          mainContext.fillRect(0, 0, canvasWidth, canvasHeight);

          mainContext.translate(centerX, centerY);

          // Draw in overlap order of back to front (stars -> torpedo -> pulse phasers -> phaser)
          for (let i = 0; i < stars.length; i++) {
            let star = stars[i];
            star.drawStar();
          }
          for (let j = 0; j < torpedoes.length; j++) {
            let torpedo = torpedoes[j];
            let fired = torpedo.drawTorpedo();
            if(fired) {
              let index = torpedoes.indexOf(torpedo);
              if (index > -1) {
                torpedoes.splice(index, 1);
              }
            }
          }
          for (let k = 0; k < pulsePhasers.length; k++) {
            let pulse = pulsePhasers[k];
            let fired = pulse.drawPulsePhaser();
            if(fired) {
              let index = pulsePhasers.indexOf(pulse);
              if (index > -1) {
                pulsePhasers.splice(index, 1);
              }
            }
          }
          for (let l = 0; l < phasers.length; l++) {
            let phaser = phasers[l];
            let fired = phaser.drawPhaser();
            if(fired) {
              let index = phasers.indexOf(phaser);
              if (index > -1) {
                phasers.splice(index, 1);
              }
            }
          }

          mainContext.translate(-centerX, -centerY);
        }

        animationId = requestAnimationFrame(draw);
      }

      /**
       * Display the viewscreen buttons for 3 seconds,
       */
      function showViewScreenHUD() {
        // show all UI buttons
        document.querySelectorAll('.turnFade').forEach(btn => {
          btn.classList.add('turnFadeOn');
        });

        // show speed selector
        document.getElementById('warpDisplay').classList.add('show');

        clearTimeout(clickTimer);
        clickTimer = setTimeout(() => {
          // fade all UI buttons
          document.querySelectorAll('.turnFadeOn').forEach(btn => {
            btn.classList.remove('turnFadeOn');
          });

          // fade the speed selector
          document.getElementById('warpDisplay').classList.remove('show');

          // Reset count if no clicks logged for 3 sec
          clickCount = 0;
        }, 3000);
      }

      /**
       * Display a message to the viewscreen for a specified amount of time.
       */
      function viewScreenMessage(msg, time) {
        let screen = document.getElementById('viewScreenMsg');
        screen.innerHTML = `<h1>${msg}</h1>`;

        clearTimeout(msgTimer);
        msgTimer = setTimeout(() => {
          screen.innerHTML = '';
        }, time);
      }

      /**
       * Display speed type and value on the viewscreen.
       * @param type Speed type (impulse, warp)
       * @param value The current speed of the stars
       */
      function displaySpeed(type, value) {
        let speedHeader, speedValue;

        // Warp speed, Mr. Sulu
        if(type === 'warp') {
          speedHeader = 'Warp Factor:';
          speedValue = value === 10 ? '9.99' : value;
        }
        // Take her out
        else {
          speedHeader = 'Sublight Speed:';

          switch(value) {
            case 0:
              speedValue = '<span class="text-danger">Full Stop<span>';
              break;
            case 0.25:
              speedValue = 'One Quarter Impulse';
              break;
            case 0.5:
              speedValue = 'Half Impulse';
              break;
            case 0.75:
              speedValue = 'Three Quarters Impulse';
              break;
            case 1:
              speedValue = 'Full Impulse';
          }
        }
        document.getElementById('speedHeader').innerHTML = speedHeader;
        document.getElementById('speedValue').innerHTML = speedValue;
      }

      /**
       * Set the current speed of the ship which changes how fast stars fly past the screen.
       * @param type Speed type (impulse, warp)
       * @param value The current speed of the stars
       */
      function setShipSpeed(type, value) {
        if(type === 'warp') {
          warpSpeed = value;
        }
        else {
          impulseSpeed = value;
        }

        // update star speed
        for (let i = 0; i < stars.length; i++) {
          stars[i].setSpeed();
        }

        displaySpeed(type, value);
      }

      /**
       * Play sound. Can be overlapped.
       * @param file The file URI
       */
      function playAudio(file) {
        let sound = new Audio(file);
        sound.play();
      }

      /**
       * Generate a random whole number between two specified values.
       * @param min The minimum value
       * @param max The maximum value
       */
      function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      /**
       * Generate a random floating point number between two specified values.
       * @param min The minimum value
       * @param max The maximum value
       */
      function getRandomFloat(min, max) {
        return Math.random() * (max - min) + min;
      }

      function remap(value, istart, istop, ostart, ostop) {
        // Ensure values are numerical to avoid potential errors
        value = Number(value);
        istart = Number(istart);
        istop = Number(istop);
        ostart = Number(ostart);
        ostop = Number(ostop);

        // Perform the mapping calculation
        return ostart + (ostop - ostart) * ((value - istart) / (istop - istart));
      }
    })();
  </script>
</body>

<footer>
  <div class="d-flex gap-3">
    <a aria-label="Check My LinkedIn" target="_blank" rel="noopener" class="link-secondary" href="https://www.linkedin.com/in/ross-lc-chan/" title="Check My LinkedIn">
      <i class="bi bi-linkedin fs-5"></i>
    </a>
    <a aria-label="Check My GitHub" target="_blank" rel="noopener" class="link-secondary" href="https://github.com/Freakium/" title="Check My GitHub">
      <i class="bi bi-github fs-5"></i>
    </a>
    <a aria-label="Send Me An Email" class="link-secondary" href="mailto:rosslcchan@gmail.com" title="Send Me An Email">
      <i class="bi bi-envelope fs-5"></i>
    </a>
  </div>
  <span><script>document.write(` Freakium ${/\d{4}/.exec(Date())[0]}`)</script></span>
</footer>

</html>